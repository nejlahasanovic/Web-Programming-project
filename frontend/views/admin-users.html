<div class="admin-wrapper">

    <!-- Sidebar -->
    <aside class="admin-sidebar" id="adminSidebar">
        <div class="sidebar-header">
            <img src="/90minut/frontend/assets/img/logo-dark.png" alt="90 Minut" class="sidebar-logo">
            <h3>Admin Panel</h3>
        </div>

        <nav class="sidebar-nav">
            <ul class="nav-list">
                <li class="nav-item">
                    <a href="#admin-dashboard" data-page="admin-dashboard">
                        <i class="fa fa-tachometer"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#admin-articles" data-page="admin-articles">
                        <i class="fa fa-newspaper-o"></i>
                        <span>Articles</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#admin-matches" data-page="admin-matches">
                        <i class="fa fa-calendar"></i>
                        <span>Matches</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#admin-leagues" data-page="admin-leagues">
                        <i class="fa fa-trophy"></i>
                        <span>Leagues</span>
                    </a>
                </li>
                <li class="nav-item active">
                    <a href="#admin-users" data-page="admin-users">
                        <i class="fa fa-users"></i>
                        <span>Users</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#admin-analytics" data-page="admin-analytics">
                        <i class="fa fa-line-chart"></i>
                        <span>Analytics</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#admin-marketing" data-page="admin-marketing">
                        <i class="fa fa-bullhorn"></i>
                        <span>Marketing</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#admin-settings" data-page="admin-settings">
                        <i class="fa fa-cog"></i>
                        <span>Settings</span>
                    </a>
                </li>
            </ul>
        </nav>

        <div class="sidebar-footer">
            <button class="btn-exit" onclick="window.location.hash='#home'">
                <i class="fa fa-home"></i>
                <span>Back to Home</span>
            </button>
        </div>
    </aside>

    <!-- Main Content Area -->
    <main class="admin-main">

        <!-- Top Navbar -->
        <header class="admin-header">
            <div class="header-left">
                <button class="sidebar-toggle" id="sidebarToggle">
                    <i class="fa fa-bars"></i>
                </button>
                <h1 class="page-title">Users Management</h1>
            </div>

            <div class="header-right">
                <!-- Admin Profile -->
                <div class="admin-profile">
                    <div class="profile-avatar-icon">
                        <i class="fa fa-user"></i>
                    </div>
                    <span class="profile-name">Admin User</span>
                </div>

                <!-- Back to Home -->
                <button class="btn-home" onclick="window.location.hash='#home'">
                    <i class="fa fa-home"></i> Back to Home
                </button>
            </div>
        </header>

        <!-- Users Content -->
        <div class="admin-content">

            <!-- Action Bar -->
            <div class="content-header">
                <div class="header-actions">
                    <button class="btn-primary" onclick="UserManagementService.openAddModal()">
                        <i class="fa fa-user-plus"></i>
                        <span>Add User</span>
                    </button>

                    <div class="search-box">
                        <i class="fa fa-search"></i>
                        <input type="text" placeholder="Search users..." id="user-search">
                    </div>
                </div>

                <div class="header-filters">
                    <select id="role-filter" class="filter-select">
                        <option value="">All Roles</option>
                        <option value="admin">Admin</option>
                        <option value="editor">Editor</option>
                        <option value="user">User</option>
                    </select>

                    <select id="sort-filter" class="filter-select">
                        <option value="newest">Newest First</option>
                        <option value="oldest">Oldest First</option>
                        <option value="alphabetical">A-Z</option>
                    </select>
                </div>
            </div>

            <!-- Users Stats -->
            <div class="mini-stats-grid">
                <div class="mini-stat-card">
                    <div class="mini-stat-icon blue">
                        <i class="fa fa-users"></i>
                    </div>
                    <div class="mini-stat-info">
                        <h4 id="totalUsers">0</h4>
                        <p>Total Users</p>
                    </div>
                </div>

                <div class="mini-stat-card">
                    <div class="mini-stat-icon green">
                        <i class="fa fa-check-circle"></i>
                    </div>
                    <div class="mini-stat-info">
                        <h4 id="activeUsers">0</h4>
                        <p>Active Users</p>
                    </div>
                </div>

                <div class="mini-stat-card">
                    <div class="mini-stat-icon orange">
                        <i class="fa fa-user-plus"></i>
                    </div>
                    <div class="mini-stat-info">
                        <h4 id="newUsers">0</h4>
                        <p>New This Month</p>
                    </div>
                </div>

                <div class="mini-stat-card">
                    <div class="mini-stat-icon red">
                        <i class="fa fa-ban"></i>
                    </div>
                    <div class="mini-stat-info">
                        <h4 id="bannedUsers">0</h4>
                        <p>Banned</p>
                    </div>
                </div>
            </div>

            <!-- Users Table -->
            <div class="data-table-container">
                <table id="users-table" class="data-table">
                    <thead>
                        <tr>
                            <th><input type="checkbox" id="selectAll"></th>
                            <th>Username</th>
                            <th>Email</th>
                            <th>Role</th>
                            <th>Created At</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Data populated by DataTables -->
                    </tbody>
                </table>
            </div>

        </div>
    </main>
</div>

<!-- Add User Modal -->
<div class="modal fade" id="add-user-modal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content bg-dark text-white">
            <div class="modal-header">
                <h5 class="modal-title">Add New User</h5>
                <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <form id="add-user-form">
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">Username *</label>
                        <input 
                            type="text" 
                            name="username" 
                            class="form-control" 
                            required 
                            minlength="7"
                            maxlength="50"
                            placeholder="Enter username (min 7 characters)"
                        />
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Email *</label>
                        <input 
                            type="email" 
                            name="email" 
                            class="form-control" 
                            required
                            placeholder="Enter email address"
                        />
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Password *</label>
                        <input 
                            type="password" 
                            name="password_hash" 
                            class="form-control" 
                            required 
                            minlength="8"
                            maxlength="20"
                            placeholder="Enter password (min 8 characters)"
                        />
                        <small class="form-text text-muted">Password must include uppercase, number, and special character</small>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Role *</label>
                        <select name="role" class="form-select" required>
                            <option value="">Select Role</option>
                            <option value="admin">Admin</option>
                            <option value="editor">Editor</option>
                            <option value="user">User</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-danger">Save User</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Edit User Modal -->
<div class="modal fade" id="edit-user-modal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content bg-dark text-white">
            <div class="modal-header">
                <h5 class="modal-title">Edit User</h5>
                <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <form id="edit-user-form">
                <input type="hidden" id="edit-user-id" name="user_id" />
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">Username *</label>
                        <input 
                            type="text" 
                            id="edit-user-username" 
                            name="username" 
                            class="form-control" 
                            required 
                            minlength="7"
                            maxlength="50"
                            placeholder="Enter username (min 7 characters)"
                        />
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Email *</label>
                        <input 
                            type="email" 
                            id="edit-user-email" 
                            name="email" 
                            class="form-control" 
                            required
                            placeholder="Enter email address"
                        />
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Password (leave empty to keep current)</label>
                        <input 
                            type="password" 
                            id="edit-user-password" 
                            name="password_hash" 
                            class="form-control" 
                            minlength="8"
                            maxlength="20"
                            placeholder="Leave empty to keep current password"
                        />
                        <small class="form-text text-muted">If changing, must include uppercase, number, and special character</small>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Role *</label>
                        <select id="edit-user-role" name="role" class="form-select" required>
                            <option value="admin">Admin</option>
                            <option value="editor">Editor</option>
                            <option value="user">User</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-danger">Update User</button>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- Delete Confirmation Modal -->
<div class="modal fade" id="confirm-delete-user-modal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content bg-dark text-white">
            <div class="modal-header">
                <h5 class="modal-title">Confirm Delete</h5>
                <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                Are you sure you want to delete this user?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" id="confirm-delete-user-btn" class="btn btn-danger">Delete</button>
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function() {
        if (typeof UserManagementService !== 'undefined') {
            UserManagementService.init();
        }
    });
</script>